<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>ê²Œì‹œê¸€ ëª©ë¡</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
    <style>
        .truncate {
            max-width: 100%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .file-icon {
            font-size: 1.2rem;
            color: #007bff;
        }
        table td, table th {
            vertical-align: middle !important;
            text-align: center;
        }
    </style>
</head>
<body>
<div class="container mt-4">
    <h1>ê²Œì‹œê¸€ ëª©ë¡</h1>

    <form th:action="@{/board/free/list}" method="get" class="row g-3 align-items-center mb-3">
        <div class="col-auto">
            <label for="startDate" class="col-form-label">ê¸°ê°„ ì‹œì‘</label>
            <input type="date" id="startDate" name="startDate" class="form-control"
                   th:value="${condition.startDate}" />
        </div>
        <div class="col-auto">
            <label for="endDate" class="col-form-label">ê¸°ê°„ ë</label>
            <input type="date" id="endDate" name="endDate" class="form-control"
                   th:value="${condition.endDate}"
                   th:attr="max=${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}"/>
        </div>

        <div class="col-auto">
            <label for="categoryId" class="col-form-label">ì¹´í…Œê³ ë¦¬</label>
            <select class="form-select" id="categoryId" name="categoryId">
                <option th:value="''" th:selected="${condition.categoryId == null}">ì „ì²´</option>
                <option th:each="cat : ${categories}"
                        th:value="${cat.id}"
                        th:text="${cat.title}"
                        th:selected="${cat.id == condition.categoryId}">
                </option>
            </select>
        </div>

        <div class="col-auto">
            <label for="keyword" class="col-form-label">ê²€ìƒ‰</label>
            <input type="text" id="keyword" name="keyword" class="form-control"
                   placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" th:value="${condition.keyword}" />
        </div>

        <div class="col-auto align-self-end">
            <button type="submit" class="btn btn-primary">ê²€ìƒ‰</button>
        </div>
    </form>

    <div>
        <p>ì´ ê²Œì‹œê¸€ ìˆ˜: <strong th:text="${postList.totalElements}">0</strong></p>
    </div>

    <table class="table table-bordered table-hover" style="table-layout: fixed;">
        <colgroup>
            <col style="width: 8%;">   <!-- ì¹´í…Œê³ ë¦¬ -->
            <col style="width: 6%;">   <!-- ì²¨ë¶€ -->
            <col style="width: 42%;">  <!-- ì œëª© -->
            <col style="width: 10%;">  <!-- ì‘ì„±ì -->
            <col style="width: 8%;">   <!-- ì¡°íšŒìˆ˜ -->
            <col style="width: 13%;">  <!-- ë“±ë¡ ì¼ì‹œ -->
            <col style="width: 13%;">  <!-- ìˆ˜ì • ì¼ì‹œ -->
        </colgroup>
        <thead class="table-light">
        <tr>
            <th>ì¹´í…Œê³ ë¦¬</th>
            <th>ì²¨ë¶€</th>
            <th>ì œëª©</th>
            <th>ì‘ì„±ì</th>
            <th>ì¡°íšŒìˆ˜</th>
            <th>ë“±ë¡ ì¼ì‹œ</th>
            <th>ìˆ˜ì • ì¼ì‹œ</th>
        </tr>
        </thead>
        <tbody>
        <tr th:if="${postList.isEmpty()}">
            <td colspan="7" class="text-center">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</td>
        </tr>
        <tr th:unless="${postList.isEmpty()}" th:each="post : ${postList.content}">
            <td th:text="${post.categoryTitle}">ì¹´í…Œê³ ë¦¬ëª…</td>
            <td>
                <span th:if="${post.hasFiles}" class="file-icon" title="ì²¨ë¶€íŒŒì¼ ìˆìŒ">ğŸ“</span>
            </td>
            <td class="truncate" th:title="${post.title}">
                <a th:href="@{'/board/free/view/' + ${post.id}}"
                   th:text="${#strings.length(post.title) > 80} ? ${#strings.concat(#strings.substring(post.title,0,80), '...')} : ${post.title}"
                   class="text-decoration-none text-dark">
                </a>
            </td>
            <td th:text="${post.username}">ì‘ì„±ì</td>
            <td th:text="${post.viewCount}">0</td>
            <td th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm')}">ë“±ë¡ì¼</td>
            <td th:text="${post.modifiedAt != null ? #temporals.format(post.modifiedAt, 'yyyy-MM-dd HH:mm') : '-'}">ìˆ˜ì •ì¼</td>
        </tr>
        </tbody>
    </table>

    <nav>
        <ul class="pagination justify-content-center">
            <li class="page-item" th:classappend="${postList.first} ? 'disabled'">
                <a class="page-link"
                   th:href="@{/board/free/list(page=${postList.number},
                                               startDate=${condition.startDate},
                                               endDate=${condition.endDate},
                                               categoryId=${condition.categoryId},
                                               keyword=${condition.keyword})}">ì´ì „</a>
            </li>
            <li class="page-item" th:each="i : ${#numbers.sequence(0, postList.totalPages - 1)}"
                th:classappend="${i == postList.number} ? 'active'">
                <a class="page-link"
                   th:href="@{/board/free/list(page=${i},
                                               startDate=${condition.startDate},
                                               endDate=${condition.endDate},
                                               categoryId=${condition.categoryId},
                                               keyword=${condition.keyword})}"
                   th:text="${i + 1}">1</a>
            </li>
            <li class="page-item" th:classappend="${postList.last} ? 'disabled'">
                <a class="page-link"
                   th:href="@{/board/free/list(page=${postList.number + 1},
                                               startDate=${condition.startDate},
                                               endDate=${condition.endDate},
                                               categoryId=${condition.categoryId},
                                               keyword=${condition.keyword})}">ë‹¤ìŒ</a>
            </li>
        </ul>
    </nav>
    <div class="d-flex justify-content-end mt-3">
        <a class="btn btn-success" th:href="@{/board/free/write}">ë“±ë¡</a>
    </div>
</div>
</body>
</html>
